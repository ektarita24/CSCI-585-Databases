CREATE EXTENSION postgis;
CREATE EXTENSION postgis_topology;

CREATE TABLE LOCATIONS (
  LOCATION_ID INTEGER PRIMARY KEY,
  LOCATION_NAME VARCHAR,
  COORDINATES GEOMETRY
);

INSERT INTO LOCATIONS VALUES (1, 'HOME', ST_MakePoint(-118.2832284,34.0297668));
INSERT INTO LOCATIONS VALUES (2, 'KCH', ST_MakePoint(-118.27974119999999,34.0284565));
INSERT INTO LOCATIONS VALUES (3, 'BLAZE', ST_MakePoint(-118.27936899,34.023229));
INSERT INTO LOCATIONS VALUES (4, 'OIS', ST_MakePoint(-118.2819356,34.021713399999996));
INSERT INTO LOCATIONS VALUES (5, 'POPOVICH HALL', ST_MakePoint(-118.2829271,34.019009));
INSERT INTO LOCATIONS VALUES (6, 'ROYAL STREET', ST_MakePoint(-118.2830551,34.0229158));
INSERT INTO LOCATIONS VALUES (7, 'THH', ST_MakePoint(-118.284254,34.0225468));
INSERT INTO LOCATIONS VALUES (8, 'SGM 123', ST_MakePoint(-118.2891262,34.0208119));
INSERT INTO LOCATIONS VALUES (9, 'TOMMY TROJAN', ST_MakePoint(-118.2849442,34.0206973));

--CONVEX HULL QUERY
SELECT ST_AsText(ST_ConvexHull(ST_Collect(COORDINATES))) As SELECTED_COORDINATES from LOCATIONS;


--NEAREST NEIGHBOUR QUERY
SELECT LOC2.LOCATION_ID, LOC2.LOCATION_NAME, ST_Distance(LOC1.COORDINATES,LOC2.COORDINATES)
FROM LOCATIONS As LOC1, LOCATIONS As LOC2
WHERE LOC1.LOCATION_NAME = 'HOME' and LOC1.LOCATION_ID != LOC2.LOCATION_ID
ORDER BY ST_Distance(LOC1.COORDINATES,LOC2.COORDINATES)
LIMIT 3;
